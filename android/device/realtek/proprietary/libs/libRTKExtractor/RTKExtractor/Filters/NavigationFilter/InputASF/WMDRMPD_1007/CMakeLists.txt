INCLUDE(../../../../../include/config.txt)

SET(LIBNAME WMDRMPD)
SET(LIBRARY_OUTPUT_PATH ../../../../../lib/)
SET(rm " /bin/rm -f")
SET(CC " ${MYCC}")
SET(LINK " -=LINK=-")
SET(DEFS )
SET(AR " ${MYAR} cq")
SET(RANLIB " ${MYRANLIB}")

SET(ORIGINAL_MAKEFILE makefile.inc.txt)
SET(FEATURE_MAKEFILE makefile.inc.2.txt)


SET(INCLUDES ${INCLUDES} " ${CMAKE_CURRENT_SOURCE_DIR}/.")
SET(INCLUDES ${INCLUDES} " ${CMAKE_CURRENT_SOURCE_DIR}/../../../../Include")
SET(INCLUDES  ${INCLUDES} " ${CMAKE_CURRENT_SOURCE_DIR}/../../../../Include/Filters")
SET(INCLUDES  ${INCLUDES} " ${CMAKE_CURRENT_SOURCE_DIR}/Source/crypto/bignum/")
SET(INCLUDES  ${INCLUDES} "
${CMAKE_CURRENT_SOURCE_DIR}/Source/crypto/drmcrypto/")

SET(DEFINES ${DEFINES} " ${DEFS} -DSYS_UNIX=1 -DHAVE_STRING_H -DRDDEBUG -DINPUT_USE_IO_PLUGIN")

IF(NOT TARGET_BOARD STREQUAL NO)
SET(DEFINES ${DEFINES} " -DTARGET_BOARD")
ENDIF(NOT TARGET_BOARD STREQUAL NO)

SET(CFLAGS " -fshort-wchar ${DEFINES} ${COMPILE_OPT}")
SET(CXXFLAGS ${CXXFLAGS} " ${DEFINES} ${COMPILE_OPT}")

IF(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)
SET(LIBNAME ../../../../../lib/libWMDRMPD.so)
SET(CFLAGS ${CFLAGS} " -fPIC -D__NAV_USE_DLL_PLUGIN__")
ELSE(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)
#SET(LIBNAME ../../../../../lib/libWMDRMPD.a)
ENDIF(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)

INCLUDE(${FEATURE_MAKEFILE})
INCLUDE(${ORIGINAL_MAKEFILE})

message(${BNG_SRCS})
SET(SRCS ${BNG_SRCS} ${PKC_SRCS} ${DRC_SRCS} ${COR_SRCS} ${BBX_SRCS} ${CMD_SRCS} ${MGR_SRCS} ${DDC_SRCS} ${DCP_SRCS} ${MTR_SRCS}  ${SCK_SRCS} ${SYN_SRCS} ${WMC_SRCS} ${TCM_SRCS} ${OEM_SRCS})

IF(DRM_SUPPORT_TOOLCOMMON STREQUAL 1)
SET(SRCS ${SRCS}  ${TCM_SCRS})
SET(OBJS ${OBJS} " ${TCM_OBJS}")
ENDIF(DRM_SUPPORT_TOOLCOMMON STREQUAL 1)

IF(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)
ELSE(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)
ENDIF(__NAV_USE_DLL_PLUGIN__ STREQUAL YES)

#message(${INCLUDES})
#message(${CFLAGS})
INCLUDE_DIRECTORIES(${INCLUDES})
ADD_DEFINITIONS(${CFLAGS} ${DEFINES} ${DEBUGFLAG} ${WARNING})
ADD_LIBRARY(${LIBNAME} ${SRCS})

string(REGEX REPLACE  ";" " " APCFG_DVR  ${APCFG_DVR})
string(REGEX REPLACE  ";" " " CHIP_MODEL_DEFS ${CHIP_MODEL_DEFS})
string(REGEX REPLACE  ";" " " APCFG_DEFS ${APCFG_DEFS})
#string(REGEX REPLACE  ";" " " BUILD_OPTIONS ${BUILD_OPTIONS})
string(REGEX REPLACE  ";" " " DEFINES ${DEFINES})
string(REGEX REPLACE  ";" " " APCFG_FLAGS ${APCFG_FLAGS})
